参考资料：https://blog.csdn.net/weixin_35755188/article/details/128869462

## jt使用的数学计算库

使用的是远古时代的代码，从lct沿用下来，包含5种运算：`加/减/乘/除/取模`

代码量：math.js 114行

加法的代码实现

```javascript
// 数字相加
export const add = (arg1: number | string, arg2: number | string): number => {
  var r1, r2, m, c;
  var s1 = arg1.toString(),
    s2 = arg2.toString();
  try {
    r1 = s1.split(".")[1].length;
  } catch (e) {
    r1 = 0;
  }
  try {
    r2 = s2.split(".")[1].length;
  } catch (e) {
    r2 = 0;
  }
  c = Math.abs(r1 - r2);
  m = Math.pow(10, Math.max(r1, r2));
  if (c > 0) {
    var cm = Math.pow(10, c);
    if (r1 > r2) {
      arg1 = Number(s1.replace(".", ""));
      arg2 = Number(s2.replace(".", "")) * cm;
    } else {
      arg1 = Number(s1.replace(".", "")) * cm;
      arg2 = Number(s2.replace(".", ""));
    }
  } else {
    arg1 = Number(s1.replace(".", ""));
    arg2 = Number(s2.replace(".", ""));
  }
  return (arg1 + arg2) / m;
};
```



### 实现思路

支持number和string类型，把数字转成字符串放大，再转成整数，然后做加减乘除，结果再缩小回去。小数位数使用toFixed()解决。

## 金融数字计算主流的库

big.js  20KB+

decimal.js 120KB+，有更佳丰富的方法可使用

### 实现思路

进行加法运算时，其内部实现的思路是基于定点数算法，以字符串或者其他非浮点数形式存储和处理大数，从而规避了JavaScript原生浮点数精度限制的问题。

步骤：

1. **初始化大数**：首先，`big.js` 会将传入的大数转换为内部表示格式，通常是将数字转换为字符串或其他可精确表示的形式。
2. **对齐数位**：由于加法需要对应数位相加，`big.js` 在进行加法之前会对参与运算的两个大数进行对齐，保证相同位置上的数字对应相加。
3. **逐位相加**：从最低位开始，逐位相加，同时记录进位（Carry）。如果有进位产生，下一位的相加结果需要加上这个进位。
4. **循环加法及处理进位**：继续对更高位进行同样的加法和进位处理，直到所有数位都已处理完毕。
5. **处理最高位的进位**：若在最后一步仍然有进位，则在最高位添加一个“1”。
6. **结果规范化**：将最终得到的内部表示转换回符合用户预期的输出格式，比如调整精度（根据配置的DP设置），并将结果作为一个新的 `Big` 对象返回。

